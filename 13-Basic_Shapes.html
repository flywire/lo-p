
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
        <link rel="canonical" href="https://flywire.github.io/lo-p/13-Basic_Shapes.html">
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.1.8">
    
    
      
        <title>Chapter 13. Drawing Basic Shapes - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.6e60f8b8.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    <script>__md_scope=new URL(".",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-13-drawing-basic-shapes" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 13. Drawing Basic Shapes
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 13. Drawing Basic Shapes
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="13-Basic_Shapes.html" class="md-nav__link md-nav__link--active">
        Chapter 13. Drawing Basic Shapes
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-drawing-shapes" class="md-nav__link">
    1.  Drawing Shapes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-a-black-dashed-line" class="md-nav__link">
    2.  A Black Dashed Line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-a-red-ellipse" class="md-nav__link">
    3.  A Red Ellipse
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-a-rectangle-with-a-variety-of-fills" class="md-nav__link">
    4.  A Rectangle with a Variety of Fills
  </a>
  
    <nav class="md-nav" aria-label="4.  A Rectangle with a Variety of Fills">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-gradient-color" class="md-nav__link">
    4.1.  Gradient Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-gradient-awt-color" class="md-nav__link">
    4.2.  Gradient AWT Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-hatching" class="md-nav__link">
    4.3.  Hatching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-bitmap-color" class="md-nav__link">
    4.4.  Bitmap Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-bitmap-file-color" class="md-nav__link">
    4.5.  Bitmap File Color
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-text" class="md-nav__link">
    5.  Text
  </a>
  
    <nav class="md-nav" aria-label="5.  Text">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#some-help-with-text-properties" class="md-nav__link">
    Some Help with Text Properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-using-a-shape-name" class="md-nav__link">
    6.  Using a Shape Name
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-a-transparent-circle-and-a-polar-line" class="md-nav__link">
    7.  A Transparent Circle and a Polar Line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-a-math-formula-as-an-ole-shape" class="md-nav__link">
    8.  A Math formula as an OLE Shape
  </a>
  
    <nav class="md-nav" aria-label="8.  A Math formula as an OLE Shape">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-other-kinds-of-ole-shape" class="md-nav__link">
    Creating Other Kinds of OLE Shape
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-polygons" class="md-nav__link">
    9.  Polygons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-mult-line-shapes" class="md-nav__link">
    10. Mult-line Shapes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-partial-ellipses" class="md-nav__link">
    11.  Partial Ellipses
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link">
        Chapter 33. Using Charts in Other Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-drawing-shapes" class="md-nav__link">
    1.  Drawing Shapes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-a-black-dashed-line" class="md-nav__link">
    2.  A Black Dashed Line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-a-red-ellipse" class="md-nav__link">
    3.  A Red Ellipse
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-a-rectangle-with-a-variety-of-fills" class="md-nav__link">
    4.  A Rectangle with a Variety of Fills
  </a>
  
    <nav class="md-nav" aria-label="4.  A Rectangle with a Variety of Fills">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-gradient-color" class="md-nav__link">
    4.1.  Gradient Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-gradient-awt-color" class="md-nav__link">
    4.2.  Gradient AWT Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-hatching" class="md-nav__link">
    4.3.  Hatching
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-bitmap-color" class="md-nav__link">
    4.4.  Bitmap Color
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-bitmap-file-color" class="md-nav__link">
    4.5.  Bitmap File Color
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-text" class="md-nav__link">
    5.  Text
  </a>
  
    <nav class="md-nav" aria-label="5.  Text">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#some-help-with-text-properties" class="md-nav__link">
    Some Help with Text Properties
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-using-a-shape-name" class="md-nav__link">
    6.  Using a Shape Name
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-a-transparent-circle-and-a-polar-line" class="md-nav__link">
    7.  A Transparent Circle and a Polar Line
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-a-math-formula-as-an-ole-shape" class="md-nav__link">
    8.  A Math formula as an OLE Shape
  </a>
  
    <nav class="md-nav" aria-label="8.  A Math formula as an OLE Shape">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-other-kinds-of-ole-shape" class="md-nav__link">
    Creating Other Kinds of OLE Shape
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#9-polygons" class="md-nav__link">
    9.  Polygons
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#10-mult-line-shapes" class="md-nav__link">
    10. Mult-line Shapes
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#11-partial-ellipses" class="md-nav__link">
    11.  Partial Ellipses
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/flywire/lo-p/edit/main/docs/13-Basic_Shapes.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>


<h1 id="chapter-13-drawing-basic-shapes">Chapter 13. Drawing Basic Shapes<a class="headerlink" href="#chapter-13-drawing-basic-shapes" title="Permanent link">&para;</a></h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>A Black Dashed
Line; A Red Ellipse;
Filled Rectangles; Text;
Shape Names; A
Transparent Circle and a
Polar Line; A Math
Formula as an OLE
Shape; Polygons;
Multiple Lines, Partial
Elipses</p>
<p>Example folders: "Draw
Tests" and "Utils"</p>
</div>
<p>This chapter contains an assortment of basic shape
creation examples, including the following:</p>
<ul>
<li>simple shapes: line, ellipse, rectangle, text;</li>
<li>shape fills: solid, gradients, hatching, bitmaps;</li>
<li>an OLE shape (a math formulae);</li>
<li>polygons, multiple lines, partial ellipses.</li>
</ul>
<p>The examples come from two files, DrawPicture.java and
AnimBicycle.java. The main() function of DrawPicture.java:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:1"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span> <span class="p">(</span><span class="n">String</span> <span class="n">args</span><span class="o">[]</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XComponentLoader</span> <span class="n">loader</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">loadOffice</span><span class="p">();</span>
  <span class="n">XComponent</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">createDrawDoc</span><span class="p">(</span><span class="n">loader</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">doc</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Draw doc creation failed&quot;</span><span class="p">);</span>
    <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">GUI</span><span class="p">.</span><span class="na">setVisible</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">delay</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>    <span class="c1">// need delay or zoom may not work</span>
  <span class="n">GUI</span><span class="p">.</span><span class="na">zoom</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="n">GUI</span><span class="p">.</span><span class="na">ENTIRE_PAGE</span><span class="p">);</span>

  <span class="n">XDrawPage</span> <span class="n">currSlide</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">getSlide</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span> <span class="c1">//access first page</span>
  <span class="n">drawShapes</span><span class="p">(</span><span class="n">currSlide</span><span class="p">);</span>

  <span class="n">Draw</span><span class="p">.</span><span class="na">drawFormula</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;func e^{i %pi} + 1 = 0&quot;</span><span class="p">,</span>
                                           <span class="mi">23</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>
  <span class="c1">// animShapes(currSlide);  // explained in Chapter 9</span>

  <span class="n">XShape</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">findShapeByName</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;text1&quot;</span><span class="p">);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">reportPosSize</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>

  <span class="n">Lo</span><span class="p">.</span><span class="na">saveDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;picture.odg&quot;</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">);</span>
  <span class="n">Lo</span><span class="p">.</span><span class="na">closeOffice</span><span class="p">();</span>
<span class="p">}</span> <span class="c1">// end of main()</span>
</code></pre></div>
</div>
</div>
</div>
<p>DrawPicture.java creates a new Draw document, and finishes by saving it to the file
"picture.odg":</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:1"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XComponent</span> <span class="n">doc</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">createDrawDoc</span><span class="p">(</span><span class="n">loader</span><span class="p">);</span>
       <span class="p">:</span>  <span class="c1">// add shapes to the document</span>
       <span class="p">:</span>
<span class="n">Lo</span><span class="p">.</span><span class="na">saveDoc</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span> <span class="s">&quot;picture.odg&quot;</span><span class="p">);</span> <span class="c1">// &quot;odg&quot; is Draw&#39;s extension</span>
</code></pre></div>
</div>
</div>
</div>
<p>Aside from saving Office formats,  Lo.saveDoc() recognizes other graphical forms
based on the filename extension (e.g. a document saved to "picture.png" will create a
PNG file).</p>
<p>Draw.createDrawDoc() is a wrapper around Lo.createDoc() to create a  Draw
document:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">XComponent</span> <span class="nf">createDrawDoc</span><span class="p">(</span><span class="n">XComponentLoader</span> <span class="n">loader</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createDoc</span><span class="p">(</span><span class="s">&quot;sdraw&quot;</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>There's also Draw.createImpressDoc():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">XComponent</span> <span class="nf">createImpressDoc</span><span class="p">(</span><span class="n">XComponentLoader</span> <span class="n">loader</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createDoc</span><span class="p">(</span><span class="s">&quot;simpress&quot;</span><span class="p">,</span> <span class="n">loader</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="1-drawing-shapes">1.  Drawing Shapes<a class="headerlink" href="#1-drawing-shapes" title="Permanent link">&para;</a></h2>
<p>The drawShapes() method inside DrawPictures.java draws the six shapes shown in
Figure 1.</p>
<p><img alt="" src="images/13-Basic_Shapes-1.jpg" /></p>
<p>Figure 1. The Six Shapes Drawn by drawShapes().</p>
<p>Almost every Draw method call Draw.makeShape() which creates a shape instance
and sets its size and position on the page:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">makeShape</span><span class="p">(</span><span class="n">String</span> <span class="n">shapeType</span><span class="p">,</span>
                       <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XShape</span> <span class="n">shape</span> <span class="o">=</span> <span class="kc">null</span><span class="p">;</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">createInstanceMSF</span><span class="p">(</span><span class="n">XShape</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                         <span class="s">&quot;com.sun.star.drawing.&quot;</span> <span class="o">+</span> <span class="n">shapeType</span><span class="p">);</span>
    <span class="n">shape</span><span class="p">.</span><span class="na">setPosition</span><span class="p">(</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="p">);</span>
    <span class="n">shape</span><span class="p">.</span><span class="na">setSize</span><span class="p">(</span> <span class="k">new</span> <span class="n">Size</span><span class="p">(</span><span class="n">width</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span> <span class="n">height</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span> <span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Unable to create shape: &quot;</span> <span class="o">+</span> <span class="n">shapeType</span><span class="p">);</span>  <span class="p">}</span>

  <span class="k">return</span> <span class="n">shape</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of makeShape()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The method assumes that the shape is defined inside the com.sun.star.drawing
package, i.e. that it's a shape which subclasses com.sun.star.drawing.Shape, like those
in Figure 6 of Chapter 11. The code converts the supplied (x, y) coordinate, width,
and height from millimeters to Office's 1/100 mm values.</p>
<p>The exact meaning of the position and the size of a shape is a little tricky. If its width
and height are positive, then the position is the top-left corner of the rectangle defined
by those dimensions. However, the user can supply negative dimensions, which
means that "top-left corner" may be on the right or bottom of the rectangle (see Figure
2(a)). Office handles this by storing the rectangle with a new top-left point, so all the
dimensions can be positive (see Figure 2(b)).</p>
<p><img alt="" src="images/13-Basic_Shapes-2.png" /></p>
<p>Figure 2. How Office Stores a Shape with a Negative Height.</p>
<p>This means that your code should not assume that the position and size of a shape
remain unchanged after being set with XShape.setPosition() and XShape.setSize().</p>
<p>makeShape() is called by Draw.addShape() which adds the generated shape to the
page. It also check if the (x, y) coordinate is located on the page. If it isn't,
warnPosition() prints a warning message.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">addShape</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span> <span class="n">String</span> <span class="n">shapeType</span><span class="p">,</span>
                            <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">)</span>
<span class="p">{</span> <span class="n">warnsPosition</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">);</span>
  <span class="n">XShape</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">makeShape</span><span class="p">(</span><span class="n">shapeType</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">shape</span> <span class="o">!=</span> <span class="kc">null</span><span class="p">)</span>
    <span class="n">slide</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">shape</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">shape</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of addShape()</span>
</code></pre></div>
</div>
</div>
</div>
<p>drawShapes() in the DrawPicture.java example is shown below. It creates the six
shapes shown in Figure 1.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in DrawPicture.java</span>
<span class="kd">private</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">drawShapes</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">currSlide</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// black dashed line; uses (x1, y1) (x2, y2)</span>
  <span class="n">XShape</span> <span class="n">line1</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawLine</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="s">&quot;LineColor&quot;</span><span class="p">,</span> <span class="mh">0x000000</span><span class="p">);</span>   <span class="c1">// black</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">setDashedLine</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
  <span class="c1">// Lo.delay(2000);  // to reduce the speed of the change</span>
  <span class="c1">// Draw.setDashedLine(line1, false);</span>


  <span class="c1">// red ellipse; uses (x, y) width, height</span>
  <span class="n">XShape</span> <span class="n">circle1</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawEllipse</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">circle1</span><span class="p">,</span> <span class="s">&quot;FillColor&quot;</span><span class="p">,</span> <span class="mh">0xFF0000</span><span class="p">);</span>


  <span class="c1">// rectangle with different fills; uses (x, y) width, height</span>
  <span class="n">XShape</span> <span class="n">rect1</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawRectangle</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
  <span class="c1">// Props.setProperty(rect1, &quot;FillColor&quot;, 0x00FF00); // green</span>
  <span class="c1">// Draw.setGradientColor(rect1, &quot;Gradient 4&quot;);</span>
                               <span class="c1">// &quot;Radial red/yellow&quot;);</span>
  <span class="c1">// Draw.setGradientColor(rect1, java.awt.Color.GREEN,</span>
                                  <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span><span class="p">.</span><span class="na">RED</span><span class="p">);</span>
  <span class="c1">// Draw.setHatchingColor(rect1, &quot;Red crossed 45 degrees&quot;);</span>
  <span class="c1">// Draw.setBitmapColor(rect1, &quot;Roses&quot;);</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">setBitmapFileColor</span><span class="p">(</span><span class="n">rect1</span><span class="p">,</span> <span class="s">&quot;crazy_blue.jpg&quot;</span><span class="p">);</span>


  <span class="c1">// text defined using (x, y), width, height [size]</span>
  <span class="n">XShape</span> <span class="n">text1</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawText</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Hello LibreOffice&quot;</span><span class="p">,</span>
                                     <span class="mi">120</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">text1</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="s">&quot;text1&quot;</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;TextShape&#39;s Text Properties&quot;</span><span class="p">,</span>
                              <span class="n">Draw</span><span class="p">.</span><span class="na">getTextProperties</span><span class="p">(</span><span class="n">text1</span><span class="p">));</span>


  <span class="c1">// gray transparent circle; uses (x,y), radius</span>
  <span class="n">XShape</span> <span class="n">circle2</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawCircle</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">circle2</span><span class="p">,</span> <span class="s">&quot;FillColor&quot;</span><span class="p">,</span>
                      <span class="n">Lo</span><span class="p">.</span><span class="na">getColorInt</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span><span class="p">.</span><span class="na">GRAY</span><span class="p">));</span>
  <span class="n">Draw</span><span class="p">.</span><span class="na">setTransparency</span><span class="p">(</span><span class="n">circle2</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span>


  <span class="c1">// thick line; uses (x,y), angle clockwise from x-axis, length</span>
  <span class="n">XShape</span> <span class="n">line2</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawPolarLine</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">line2</span><span class="p">,</span> <span class="s">&quot;LineWidth&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>    <span class="c1">// 3mm</span>
<span class="p">}</span>  <span class="c1">// end of drawShapes()</span>
</code></pre></div>
</div>
</div>
</div>
<p>There's a number of variations possible for each shape, represented by commented out
code. The following sections look at how the six shapes are drawn.</p>
<h2 id="2-a-black-dashed-line">2.  A Black Dashed Line<a class="headerlink" href="#2-a-black-dashed-line" title="Permanent link">&para;</a></h2>
<p>Draw.drawLine() calls Draw.addShape() to create a com.sun.star.drawing.LineShape
instance. In common with other shapes, a line is defined in terms of its enclosing
rectangle, represented by its top-left corner, width, and height. Draw.drawLine()
allows the programmer to define the line using its endpoints:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="__tabbed_8_1" name="__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="__tabbed_8_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">drawLine</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span>
                  <span class="kt">int</span> <span class="n">x1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y1</span><span class="p">,</span> <span class="kt">int</span> <span class="n">x2</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y2</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// make sure size is non-zero</span>
  <span class="k">if</span> <span class="p">((</span><span class="n">x1</span> <span class="o">==</span> <span class="n">x2</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="p">(</span><span class="n">y1</span> <span class="o">==</span> <span class="n">y2</span><span class="p">))</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Line is a point&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">int</span> <span class="n">width</span> <span class="o">=</span> <span class="n">x2</span> <span class="o">-</span> <span class="n">x1</span><span class="p">;</span>   <span class="c1">// may be negative</span>
  <span class="kt">int</span> <span class="n">height</span> <span class="o">=</span> <span class="n">y2</span> <span class="o">-</span> <span class="n">y1</span><span class="p">;</span>  <span class="c1">// may be negative</span>
  <span class="k">return</span> <span class="n">addShape</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="s">&quot;LineShape&quot;</span><span class="p">,</span>  <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of drawLine()</span>
</code></pre></div>
</div>
</div>
</div>
<p>As mentioned above, Office will store a shape with a modified position and size if one
or both of its dimensions is negative. As an example, consider if Draw.drawLine() is
called with the coordinates (10,20) and (20,10). The call to addShape() would be
passed a positive width (10mm) and a negative height (-10mm). This would be drawn
as in Figure 3(a) but would be stored using the shape position and size in Figure 3&copy;.</p>
<p><img alt="" src="images/13-Basic_Shapes-3.png" /></p>
<p>Figure 3. How a Line with a Negative Height is Stored as a Shape.</p>
<p>This kind of transformation may be important if your code modifies a shape after it
has been added to the slide, as my animation examples do in the next chapter.</p>
<p>Back in DrawPicture.java's drawShapes(), the line's properties are adjusted. The
hardest part of this is finding the property's name in the API documentation, because
properties are typically defined across multiple services, including LineShape, Shape,
FillProperties, ShadowProperties, LineProperties, and RotationDescriptor. If the
property is related to the shape's text then you should check TextProperties,
CharacterProperties, and ParagraphProperties as well. Figure 7 of Chapter 11 shows
the situation for RectangleShape, and its much the same for other shapes. You should
start looking in the documentation for the shape (i.e. use
<code>lodoc LineShape drawing</code>), and move up the hierarchy.</p>
<p>You can click on the inheritance diagram at the top of the page (e.g. like the one in
Figure 4) to look in the different services.</p>
<p><img alt="" src="images/13-Basic_Shapes-4.png" /></p>
<p>Figure 4. The LineShape Inheritance Diagram in the
LibreOffice Online Documentation.</p>
<p>drawShapes() will color the line black and make it dashed, which suggests that I
should examine the LineProperties class. Its relevant properties are "LineColor" for
color and "LineStyle" and "LineDash" for creating dashes, as in Figure 5.</p>
<p><img alt="" src="images/13-Basic_Shapes-5.png" /></p>
<p>Figure 5. Relevant Properties in the LineProperties Class.</p>
<p>Line color can be set with a single call to Props.setProperty(), but line dashing is a
little more complicated, so is handled by Draw.setDashedLine():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:1"><input checked="checked" id="__tabbed_9_1" name="__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="__tabbed_9_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in drawShapes() in DrawPicture.java</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="s">&quot;LineColor&quot;</span><span class="p">,</span> <span class="mh">0x000000</span><span class="p">);</span>   <span class="c1">// black</span>
<span class="n">Draw</span><span class="p">.</span><span class="na">setDashedLine</span><span class="p">(</span><span class="n">line1</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The color parameter for "LineColor" is an RGB hexadecimal. There are other ways of
defining color, which I'll explain in a moment.</p>
<p>Draw.setDashedLine() has to assign a LineStyle object to "LineStyle" and a LineDash
object to "LineDash". The line style is easily set since LineStyle is an enumeration
with three possible values. A LineDash object requires more work:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="10:1"><input checked="checked" id="__tabbed_10_1" name="__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="__tabbed_10_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setDashedLine</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span><span class="p">,</span> <span class="kt">boolean</span> <span class="n">isDashed</span><span class="p">)</span>
<span class="p">{</span>
  <span class="c1">// create a LineDash object</span>
  <span class="n">LineDash</span> <span class="n">ld</span> <span class="o">=</span> <span class="k">new</span> <span class="n">LineDash</span><span class="p">();</span>
  <span class="n">ld</span><span class="p">.</span><span class="na">Dots</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">ld</span><span class="p">.</span><span class="na">DotLen</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>  <span class="c1">// dashes only; no dots</span>
  <span class="n">ld</span><span class="p">.</span><span class="na">Dashes</span> <span class="o">=</span> <span class="mi">5</span><span class="p">;</span>
  <span class="n">ld</span><span class="p">.</span><span class="na">DashLen</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>
  <span class="n">ld</span><span class="p">.</span><span class="na">Distance</span> <span class="o">=</span> <span class="mi">200</span><span class="p">;</span>

  <span class="c1">// set the properties for the line</span>
  <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">shape</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">isDashed</span><span class="p">)</span> <span class="p">{</span>  <span class="c1">// draw a dashed line</span>
      <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;LineStyle&quot;</span><span class="p">,</span> <span class="n">LineStyle</span><span class="p">.</span><span class="na">DASH</span><span class="p">);</span>
      <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;LineDash&quot;</span><span class="p">,</span> <span class="n">ld</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="c1">// draw a solid line</span>
      <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;LineStyle&quot;</span><span class="p">,</span> <span class="n">LineStyle</span><span class="p">.</span><span class="na">SOLID</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not set dashed line property&quot;</span><span class="p">);</span>  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setDashedLine()</span>
</code></pre></div>
</div>
</div>
</div>
<p>setDashedLine() can be used to toggle a line's dashes on or off.</p>
<h2 id="3-a-red-ellipse">3.  A Red Ellipse<a class="headerlink" href="#3-a-red-ellipse" title="Permanent link">&para;</a></h2>
<p>A red ellipse is drawn using:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:1"><input checked="checked" id="__tabbed_11_1" name="__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="__tabbed_11_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in drawShapes() in DrawPicture.java</span>
<span class="n">XShape</span> <span class="n">circle1</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawEllipse</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">circle1</span><span class="p">,</span> <span class="s">&quot;FillColor&quot;</span><span class="p">,</span> <span class="mh">0xFF0000</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Draw.drawEllipse() is similar to drawLine() except that an EllipseShape is created by
Draw.addShape():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:1"><input checked="checked" id="__tabbed_12_1" name="__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="__tabbed_12_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">drawEllipse</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span>
                           <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">)</span>
<span class="p">{</span>  <span class="k">return</span> <span class="n">addShape</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="s">&quot;EllipseShape&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>  <span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>I want to fill the circle with a solid color, which suggests the setting of a property in
FillProperties. A visit to the online documentation for EllipseShape reveals an
inheritance diagram like the one in Figure 6.</p>
<p><img alt="" src="images/13-Basic_Shapes-6.png" /></p>
<p>Figure 6. The EllipseShape Inheritance Diagram in the
LibreOffice Online Documentation.</p>
<p>Clicking on the FillProperties rectangle jumps to its documentation, which lists a
"FillColor" property (see Figure 7).</p>
<p><img alt="" src="images/13-Basic_Shapes-7.png" /></p>
<p>Figure 7. Relevant Properties in the FillProperties Class.</p>
<p>Both the "FillColor" and "FillStyle" properties should be set, but the default value for
"FillStyle" is already FillStyle.SOLID, which is what's needed.</p>
<h2 id="4-a-rectangle-with-a-variety-of-fills">4.  A Rectangle with a Variety of Fills<a class="headerlink" href="#4-a-rectangle-with-a-variety-of-fills" title="Permanent link">&para;</a></h2>
<p>The rectangle example in drawShapes() comes in six different colors:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:1"><input checked="checked" id="__tabbed_13_1" name="__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="__tabbed_13_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>  <span class="c1">// in drawShapes() in DrawPicture.java</span>
  <span class="c1">// rectangle with different fills</span>
  <span class="n">XShape</span> <span class="n">rect1</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawRectangle</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">50</span><span class="p">);</span>
  <span class="c1">// Props.setProperty(rect1, &quot;FillColor&quot;, 0x00FF00); // green</span>

  <span class="c1">// Draw.setGradientColor(rect1, &quot;Gradient 4&quot;);</span>
                                      <span class="c1">// &quot;Radial red/yellow&quot;);</span>

  <span class="c1">// Draw.setGradientColor(rect1, java.awt.Color.GREEN,</span>
                                  <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span><span class="p">.</span><span class="na">RED</span><span class="p">);</span>

  <span class="c1">// Draw.setHatchingColor(rect1, &quot;Red crossed 45 degrees&quot;);</span>

  <span class="c1">// Draw.setBitmapColor(rect1, &quot;Roses&quot;);</span>

  <span class="n">Draw</span><span class="p">.</span><span class="na">setBitmapFileColor</span><span class="p">(</span><span class="n">rect1</span><span class="p">,</span> <span class="s">&quot;crazy_blue.jpg&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>They're shown in Figure 8.</p>
<p><img alt="" src="images/13-Basic_Shapes-8.jpg" /></p>
<p>Figure 8. Six Ways of Filling a Rectangle.</p>
<h3 id="41-gradient-color">4.1.  Gradient Color<a class="headerlink" href="#41-gradient-color" title="Permanent link">&para;</a></h3>
<p>The second example in Figure 8 ("gradient color") is implemented using
Draw.setGradientColor():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:1"><input checked="checked" id="__tabbed_14_1" name="__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="__tabbed_14_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setGradientColor</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">shape</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FillStyle&quot;</span><span class="p">,</span> <span class="n">FillStyle</span><span class="p">.</span><span class="na">GRADIENT</span><span class="p">);</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FillGradientName&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">IllegalArgumentException</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;\&quot; is not a</span>
<span class="s">                        recognized gradient color name&quot;</span><span class="p">);</span>  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not set to \&quot;&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setGradientColor()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The hardest part of using this function is determining what name value to pass to the
"FillGradientName" property (e.g. "Gradient 4" in the call in drawShapes()). The
easiest solution is to fire up Office's Draw application, and check out the gradient
names listed in the "Line and Filling" toolbar. Figure 9 shows what happens when the
user selects a shape and chooses the "Gradient" menu item from the combo box.</p>
<p><img alt="" src="images/13-Basic_Shapes-9.png" /></p>
<p>Figure 9. The Gradient Names in LibreOffice.</p>
<p>If you supply a name which is not in Figure 9's list, then "Linear blue/white" is used
instead.</p>
<h3 id="42-gradient-awt-color">4.2.  Gradient AWT Color<a class="headerlink" href="#42-gradient-awt-color" title="Permanent link">&para;</a></h3>
<p>The third example in Figure 8 shows what happens when you define your own
gradient and angle of change. In drawShapes(), the call is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:1"><input checked="checked" id="__tabbed_15_1" name="__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="__tabbed_15_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">Draw</span><span class="p">.</span><span class="na">setGradientColor</span><span class="p">(</span><span class="n">rect1</span><span class="p">,</span> <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span><span class="p">.</span><span class="na">GREEN</span><span class="p">,</span>
                                  <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span><span class="p">.</span><span class="na">RED</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>This creates a gradient change from green to red downwards through the shape.</p>
<p>Draw.setGradientColor() calls a four argument version of itself which specifies the
gradient angle:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:1"><input checked="checked" id="__tabbed_16_1" name="__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="__tabbed_16_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setGradientColor</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span><span class="p">,</span>
              <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span> <span class="n">startColor</span><span class="p">,</span> <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span> <span class="n">endColor</span><span class="p">)</span>
<span class="p">{</span>  <span class="n">setGradientColor</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">startColor</span><span class="p">,</span> <span class="n">endColor</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>  <span class="p">}</span>


<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setGradientColor</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span><span class="p">,</span>
   <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span> <span class="n">startColor</span><span class="p">,</span> <span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span> <span class="n">endColor</span><span class="p">,</span> <span class="kt">int</span> <span class="n">angle</span><span class="p">)</span>
<span class="cm">/* if angle == 90 then the gradient changes from the left</span>
<span class="cm">   to the right side of the shape */</span>
<span class="p">{</span>
  <span class="c1">// create Gradient object</span>
  <span class="n">Gradient</span> <span class="n">grad</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Gradient</span><span class="p">();</span>
  <span class="n">grad</span><span class="p">.</span><span class="na">Style</span> <span class="o">=</span> <span class="n">GradientStyle</span><span class="p">.</span><span class="na">LINEAR</span><span class="p">;</span>
  <span class="n">grad</span><span class="p">.</span><span class="na">StartColor</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">getColorInt</span><span class="p">(</span><span class="n">startColor</span><span class="p">);</span>
  <span class="n">grad</span><span class="p">.</span><span class="na">EndColor</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">getColorInt</span><span class="p">(</span><span class="n">endColor</span><span class="p">);</span>

  <span class="n">grad</span><span class="p">.</span><span class="na">Angle</span> <span class="o">=</span> <span class="p">(</span><span class="kt">short</span><span class="p">)(</span><span class="n">angle</span><span class="o">*</span><span class="mi">10</span><span class="p">);</span>    <span class="c1">// in 1/10 degree units</span>
  <span class="n">grad</span><span class="p">.</span><span class="na">Border</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">grad</span><span class="p">.</span><span class="na">XOffset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">grad</span><span class="p">.</span><span class="na">YOffset</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="n">grad</span><span class="p">.</span><span class="na">StartIntensity</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span> <span class="n">grad</span><span class="p">.</span><span class="na">EndIntensity</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
  <span class="n">grad</span><span class="p">.</span><span class="na">StepCount</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

  <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">shape</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FillStyle&quot;</span><span class="p">,</span> <span class="n">FillStyle</span><span class="p">.</span><span class="na">GRADIENT</span><span class="p">);</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FillGradient&quot;</span><span class="p">,</span> <span class="n">grad</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not set gradient colors&quot;</span><span class="p">);</span>  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setGradientColor()</span>
</code></pre></div>
</div>
</div>
</div>
<p>setGradientColor() sets the properties "FillStyle" and "FillGradient". The latter
requires a Gradient object, which is documented in the FillProperties class, as shown
in Figure 10.</p>
<p><img alt="" src="images/13-Basic_Shapes-10.png" /></p>
<p>Figure 10. The "FillGradient" Property in the FillProperties Class.</p>
<p>The online documentation for FillProperties can be reached using lodoc
FillProperties service reference.</p>
<p>Clicking on the "com::sun:<img alt="" class="twemoji" src="https://twemoji.maxcdn.com/v/latest/svg/2b50.svg" title=":star:" />:awt::Gradient" name in Figure 10 loads its
documentation, which lists ten fields that need to be set.</p>
<p>The colors passed to Draw.setGradientColor() are the Java AWT constants for red and
green (java.awt.Color.RED and java.awt.Color.GREEN), but any Color objects could
be used. They're converted to hexadecimals by Lo.getColorInt():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:1"><input checked="checked" id="__tabbed_17_1" name="__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="__tabbed_17_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">int</span> <span class="nf">getColorInt</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span> <span class="n">color</span><span class="p">)</span>
<span class="c1">// return the color as an integer, ignoring the alpha channel</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">color</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No color supplied&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">color</span><span class="p">.</span><span class="na">getRGB</span><span class="p">()</span> <span class="o">&amp;</span> <span class="mh">0xffffff</span><span class="p">);</span>
<span class="p">}</span> <span class="c1">// end of getColorInt()</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="43-hatching">4.3.  Hatching<a class="headerlink" href="#43-hatching" title="Permanent link">&para;</a></h3>
<p>The fourth fill in Figure 8 employs hatching. In drawShapes(), the call is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:1"><input checked="checked" id="__tabbed_18_1" name="__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="__tabbed_18_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">Draw</span><span class="p">.</span><span class="na">setHatchingColor</span><span class="p">(</span><span class="n">rect1</span><span class="p">,</span> <span class="s">&quot;Red crossed 45 degrees&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Draw.setHatchingColor() is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:1"><input checked="checked" id="__tabbed_19_1" name="__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="__tabbed_19_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setHatchingColor</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">shape</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FillStyle&quot;</span><span class="p">,</span> <span class="n">FillStyle</span><span class="p">.</span><span class="na">HATCH</span><span class="p">);</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FillHatchName&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">IllegalArgumentException</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;\&quot; not a hatching name&quot;</span><span class="p">);</span>  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not set color \&quot;&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setHatchingColor()</span>
</code></pre></div>
</div>
</div>
</div>
<p>This function is much the same as setGradientColor() except that it utilizes
"FillHatchName" rather than "FillGradientName", and the fill style is set to
FillStyle.HATCH. Suitable hatching names can be found by looking at the relevant
list in Draw's "Line and Filling" toolbar. Figure 11 shows the "Hatching" menu item.</p>
<p><img alt="" src="images/13-Basic_Shapes-11.png" /></p>
<p>Figure 11. The Hatching Names in LibreOffice.</p>
<h3 id="44-bitmap-color">4.4.  Bitmap Color<a class="headerlink" href="#44-bitmap-color" title="Permanent link">&para;</a></h3>
<p>The fifth rectangle fill in Figure 8 utilizes a bitmap color:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:1"><input checked="checked" id="__tabbed_20_1" name="__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="__tabbed_20_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">Draw</span><span class="p">.</span><span class="na">setBitmapColor</span><span class="p">(</span><span class="n">rect1</span><span class="p">,</span> <span class="s">&quot;Roses&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The function is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:1"><input checked="checked" id="__tabbed_21_1" name="__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="__tabbed_21_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setBitmapColor</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span><span class="p">,</span> <span class="n">String</span> <span class="n">name</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">shape</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FillStyle&quot;</span><span class="p">,</span> <span class="n">FillStyle</span><span class="p">.</span><span class="na">BITMAP</span><span class="p">);</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FillBitmapName&quot;</span><span class="p">,</span> <span class="n">name</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">com</span><span class="p">.</span><span class="na">sun</span><span class="p">.</span><span class="na">star</span><span class="p">.</span><span class="na">lang</span><span class="p">.</span><span class="na">IllegalArgumentException</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\&quot;&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;\&quot; is not a bitmap&quot;</span><span class="p">);</span>  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not set to \&quot;&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setBitmapColor()</span>
</code></pre></div>
</div>
</div>
</div>
<p>This is also similar to setGradientColor() and setHatchingColor() but uses a different
"FillStyle" value, and assigns a name to "FillBitmapName". As you might have
guessed by now, the best source for these names is the  "Line and Filling" toolbar
shown in Figure 12.</p>
<p><img alt="" src="images/13-Basic_Shapes-12.png" /></p>
<p>Figure 12. The Bitmap Names in LibreOffice.</p>
<h3 id="45-bitmap-file-color">4.5.  Bitmap File Color<a class="headerlink" href="#45-bitmap-file-color" title="Permanent link">&para;</a></h3>
<p>The final fill in Figure 8 loads a bitmap from "crazy_blue.jpg":
Draw.setBitmapFileColor(rect1, "crazy_blue.jpg");
setBitmapFileColor() is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="22:1"><input checked="checked" id="__tabbed_22_1" name="__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="__tabbed_22_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">setBitmapFileColor</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span><span class="p">,</span> <span class="n">String</span> <span class="n">fnm</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XPropertySet</span> <span class="n">props</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">shape</span><span class="p">);</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FillStyle&quot;</span><span class="p">,</span> <span class="n">FillStyle</span><span class="p">.</span><span class="na">BITMAP</span><span class="p">);</span>
    <span class="n">props</span><span class="p">.</span><span class="na">setPropertyValue</span><span class="p">(</span><span class="s">&quot;FillBitmapURL&quot;</span><span class="p">,</span> <span class="n">FileIO</span><span class="p">.</span><span class="na">fnmToURL</span><span class="p">(</span><span class="n">fnm</span><span class="p">));</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Could not set color \&quot;&quot;</span> <span class="o">+</span> <span class="n">fnm</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>  <span class="p">}</span>
<span class="p">}</span>  <span class="c1">// end of setBitmapFileColor()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The "FillBitmapURL" property requires a URL, so the filename is converted by
FileIO.fnmToURL().</p>
<h2 id="5-text">5.  Text<a class="headerlink" href="#5-text" title="Permanent link">&para;</a></h2>
<p>The "Hello LibreOffice" text shape in Figure 1 is created by calling Draw.drawText():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="23:1"><input checked="checked" id="__tabbed_23_1" name="__tabbed_23" type="radio" /><div class="tabbed-labels"><label for="__tabbed_23_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">XShape</span> <span class="n">text1</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawText</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;Hello LibreOffice&quot;</span><span class="p">,</span>
                             <span class="mi">120</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">24</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The first four numerical parameters define the shape's bounding rectangle in terms of
its top-left coordinate, width, and height. The fifth, optional number specifies a font
size (in this case, 24pt).</p>
<p>drawText() calls addShape() with "TextShape":</p>
<div class="tabbed-set tabbed-alternate" data-tabs="24:1"><input checked="checked" id="__tabbed_24_1" name="__tabbed_24" type="radio" /><div class="tabbed-labels"><label for="__tabbed_24_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">drawText</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span> <span class="n">String</span> <span class="n">msg</span><span class="p">,</span>
            <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">,</span> <span class="kt">int</span> <span class="n">fontSize</span><span class="p">)</span>
<span class="p">{</span> <span class="n">XShape</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">addShape</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="s">&quot;TextShape&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
  <span class="n">addText</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">fontSize</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">shape</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of drawText()</span>
</code></pre></div>
</div>
</div>
</div>
<p>addText() adds the message to the shape, and sets its font size:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="25:1"><input checked="checked" id="__tabbed_25_1" name="__tabbed_25" type="radio" /><div class="tabbed-labels"><label for="__tabbed_25_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addText</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span><span class="p">,</span> <span class="n">String</span> <span class="n">msg</span><span class="p">,</span> <span class="kt">int</span> <span class="n">fontSize</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XText</span> <span class="n">xText</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">shape</span><span class="p">);</span>
  <span class="n">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">xText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>
  <span class="n">cursor</span><span class="p">.</span><span class="na">gotoEnd</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">fontSize</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">cursor</span><span class="p">,</span> <span class="s">&quot;CharHeight&quot;</span><span class="p">,</span> <span class="n">fontSize</span><span class="p">);</span>
  <span class="n">XTextRange</span> <span class="n">range</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTextRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cursor</span><span class="p">);</span>
  <span class="n">range</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="n">msg</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of addText()</span>
</code></pre></div>
</div>
</div>
</div>
<p>The shape is converted into an XText reference, and the text range selected with a
cursor.</p>
<p>The "CharHeight" property comes from the CharacterProperties service, which is
inherited by the Text service (as shown in Figure 7 of Chapter 11).</p>
<h4 id="some-help-with-text-properties">Some Help with Text Properties<a class="headerlink" href="#some-help-with-text-properties" title="Permanent link">&para;</a></h4>
<p>The text-related properties for a shape can be accessed with
Draw.getTextProperties():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="26:1"><input checked="checked" id="__tabbed_26_1" name="__tabbed_26" type="radio" /><div class="tabbed-labels"><label for="__tabbed_26_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">XPropertySet</span> <span class="nf">getTextProperties</span><span class="p">(</span><span class="n">XShape</span> <span class="n">xShape</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XText</span> <span class="n">xText</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XText</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xShape</span><span class="p">);</span>
  <span class="n">XTextCursor</span> <span class="n">cursor</span> <span class="o">=</span> <span class="n">xText</span><span class="p">.</span><span class="na">createTextCursor</span><span class="p">();</span>
  <span class="n">cursor</span><span class="p">.</span><span class="na">gotoStart</span><span class="p">(</span><span class="kc">false</span><span class="p">);</span>
  <span class="n">cursor</span><span class="p">.</span><span class="na">gotoEnd</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
  <span class="n">XTextRange</span> <span class="n">xTextRange</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XTextRange</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">cursor</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XPropertySet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">xTextRange</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of getTextProperties()</span>
</code></pre></div>
</div>
</div>
</div>
<p>drawShapes() in DrawPicture.java calls Draw.getTextProperties() on the text1
TextShape, and prints all its properties:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="27:1"><input checked="checked" id="__tabbed_27_1" name="__tabbed_27" type="radio" /><div class="tabbed-labels"><label for="__tabbed_27_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in drawShapes() in DrawPicture.java</span>
<span class="n">Props</span><span class="p">.</span><span class="na">showProps</span><span class="p">(</span><span class="s">&quot;TextShape&#39;s Text Properties&quot;</span><span class="p">,</span>
                                <span class="n">Draw</span><span class="p">.</span><span class="na">getTextProperties</span><span class="p">(</span><span class="n">text1</span><span class="p">));</span>
</code></pre></div>
</div>
</div>
</div>
<p>The output is long, but includes the line:</p>
<div class="highlight"><pre><span></span><code>CharHeight == 24.0
</code></pre></div>
<p>which indicates that the font size was correctly changed by the earlier call to
Draw.drawText().</p>
<h2 id="6-using-a-shape-name">6.  Using a Shape Name<a class="headerlink" href="#6-using-a-shape-name" title="Permanent link">&para;</a></h2>
<p>Immediately after the call to Draw.drawText(), the shape's name is set:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="28:1"><input checked="checked" id="__tabbed_28_1" name="__tabbed_28" type="radio" /><div class="tabbed-labels"><label for="__tabbed_28_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in drawShapes() in DrawPicture.java</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">text1</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">,</span> <span class="s">&quot;text1&quot;</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The "Name" property, which is defined in the Shape class, is a useful way of referring
to a shape. The main() function of DrawPicture.java passes a name to
Draw.findShapeByName():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="29:1"><input checked="checked" id="__tabbed_29_1" name="__tabbed_29" type="radio" /><div class="tabbed-labels"><label for="__tabbed_29_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in main() in DrawPicture.java</span>
<span class="n">XShape</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">findShapeByName</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;text1&quot;</span><span class="p">);</span>
<span class="n">Draw</span><span class="p">.</span><span class="na">reportPosSize</span><span class="p">(</span><span class="n">s</span><span class="p">);</span>

<span class="n">Draw</span><span class="p">.</span><span class="na">findShapeByName</span><span class="p">()</span> <span class="n">iterates</span> <span class="n">through</span> <span class="n">a</span> <span class="n">list</span> <span class="n">of</span> <span class="n">shapes</span> <span class="n">extracted</span> <span class="n">from</span> <span class="n">the</span> <span class="n">slide</span><span class="p">,</span>
<span class="n">and</span> <span class="n">returns</span> <span class="n">the</span> <span class="n">shape</span> <span class="n">with</span> <span class="n">the</span> <span class="n">supplied</span> <span class="n">name</span><span class="p">:</span>

<span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">findShapeByName</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span>
                                     <span class="n">String</span> <span class="n">shapeName</span><span class="p">)</span>
<span class="p">{</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XShape</span><span class="o">&gt;</span> <span class="n">shapes</span> <span class="o">=</span> <span class="n">getShapes</span><span class="p">(</span><span class="n">slide</span><span class="p">);</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">shapes</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No shapes were found in the draw page&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="k">for</span> <span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span> <span class="p">:</span> <span class="n">shapes</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">String</span> <span class="n">nm</span> <span class="o">=</span> <span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">shapeName</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="n">nm</span><span class="p">))</span>
      <span class="k">return</span> <span class="n">shape</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;No shape named \&quot;&quot;</span> <span class="o">+</span> <span class="n">shapeName</span> <span class="o">+</span> <span class="s">&quot;\&quot;&quot;</span><span class="p">);</span>
  <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of findShapeByName()</span>
</code></pre></div>
</div>
</div>
</div>
<p>Draw.getShapes() builds a list of shapes by iterating through the XDrawPage object
as an indexed container of shapes:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="30:1"><input checked="checked" id="__tabbed_30_1" name="__tabbed_30" type="radio" /><div class="tabbed-labels"><label for="__tabbed_30_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XShape</span><span class="o">&gt;</span> <span class="nf">getShapes</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">slide</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Slide is null&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">slide</span><span class="p">.</span><span class="na">getCount</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Slide does not contain any shapes&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XShape</span><span class="o">&gt;</span> <span class="n">xShapesList</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">XShape</span><span class="o">&gt;</span><span class="p">();</span>
  <span class="k">try</span> <span class="p">{</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">slide</span><span class="p">.</span><span class="na">getCount</span><span class="p">();</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
      <span class="n">xShapesList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XShape</span><span class="p">.</span><span class="na">class</span><span class="p">,</span> <span class="n">slide</span><span class="p">.</span><span class="na">getByIndex</span><span class="p">(</span><span class="n">j</span><span class="p">)));</span>
  <span class="p">}</span>
  <span class="k">catch</span><span class="p">(</span><span class="n">Exception</span> <span class="n">e</span><span class="p">)</span>
  <span class="p">{</span>   <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Shapes extraction error in slide&quot;</span><span class="p">);</span>  <span class="p">}</span>

  <span class="k">return</span> <span class="n">xShapesList</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of getShapes()</span>
</code></pre></div>
</div>
</div>
</div>
<p>Draw.reportPosSize() prints some brief information about a shape, including its name,
shape type, position, and size:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="31:1"><input checked="checked" id="__tabbed_31_1" name="__tabbed_31" type="radio" /><div class="tabbed-labels"><label for="__tabbed_31_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">reportPosSize</span><span class="p">(</span><span class="n">XShape</span> <span class="n">shape</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">shape</span> <span class="o">==</span> <span class="kc">null</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;The shape is null&quot;</span><span class="p">);</span>
    <span class="k">return</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Shape name: &quot;</span> <span class="o">+</span>
                        <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="s">&quot;Name&quot;</span><span class="p">));</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  Type: &quot;</span> <span class="o">+</span> <span class="n">shape</span><span class="p">.</span><span class="na">getShapeType</span><span class="p">());</span>
  <span class="n">Point</span> <span class="n">pt</span> <span class="o">=</span> <span class="n">shape</span><span class="p">.</span><span class="na">getPosition</span><span class="p">();</span>
  <span class="n">Size</span> <span class="n">sz</span> <span class="o">=</span> <span class="n">shape</span><span class="p">.</span><span class="na">getSize</span><span class="p">();</span>
  <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;  Position/size: (&quot;</span> <span class="o">+</span>
               <span class="n">pt</span><span class="p">.</span><span class="na">X</span><span class="o">/</span><span class="mi">100</span> <span class="o">+</span> <span class="s">&quot;, &quot;</span> <span class="o">+</span>  <span class="n">pt</span><span class="p">.</span><span class="na">Y</span><span class="o">/</span><span class="mi">100</span> <span class="o">+</span>  <span class="s">&quot;) / (&quot;</span> <span class="o">+</span>
               <span class="n">sz</span><span class="p">.</span><span class="na">Width</span><span class="o">/</span><span class="mi">100</span> <span class="o">+</span> <span class="s">&quot;, &quot;</span> <span class="o">+</span> <span class="n">sz</span><span class="p">.</span><span class="na">Height</span><span class="o">/</span><span class="mi">100</span> <span class="o">+</span> <span class="s">&quot;)&quot;</span><span class="p">);</span>
<span class="p">}</span>  <span class="c1">// end of reportPosSize()</span>
</code></pre></div>
</div>
</div>
</div>
<p>XShape.getShapeType() returns the class name of the shape as a string (in this case,
"com.sun.star.drawing.TextShape").</p>
<h2 id="7-a-transparent-circle-and-a-polar-line">7.  A Transparent Circle and a Polar Line<a class="headerlink" href="#7-a-transparent-circle-and-a-polar-line" title="Permanent link">&para;</a></h2>
<p>The last two shapes created by DrawPicture.java's drawShapes() are a gray
transparent circle and a polar line.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="32:1"><input checked="checked" id="__tabbed_32_1" name="__tabbed_32" type="radio" /><div class="tabbed-labels"><label for="__tabbed_32_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in drawShapes() in DrawPicture.java</span>
<span class="c1">// gray transparent circle; uses (x,y), radius</span>
<span class="n">XShape</span> <span class="n">circle2</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawCircle</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">150</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">circle2</span><span class="p">,</span> <span class="s">&quot;FillColor&quot;</span><span class="p">,</span>
                  <span class="n">Lo</span><span class="p">.</span><span class="na">getColorInt</span><span class="p">(</span><span class="n">java</span><span class="p">.</span><span class="na">awt</span><span class="p">.</span><span class="na">Color</span><span class="p">.</span><span class="na">GRAY</span><span class="p">));</span>
<span class="n">Draw</span><span class="p">.</span><span class="na">setTransparency</span><span class="p">(</span><span class="n">circle2</span><span class="p">,</span> <span class="mi">25</span><span class="p">);</span>

<span class="c1">// thick line; uses (x,y), angle clockwise from x-axis, length</span>
<span class="n">XShape</span> <span class="n">line2</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawPolarLine</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">line2</span><span class="p">,</span> <span class="s">&quot;LineWidth&quot;</span><span class="p">,</span> <span class="mi">300</span><span class="p">);</span>    <span class="c1">// 3mm</span>
</code></pre></div>
</div>
</div>
</div>
<p>A polar line is one defined using polar coordinates, which specifies the coordinate of
one end of the line, and the angle and length of the line from that point.</p>
<p>Draw.drawCircle() uses an EllipseShape, and Draw.drawPolarLine() converts the
polar values into two coordinates so Draw.drawLine() can be called.</p>
<h2 id="8-a-math-formula-as-an-ole-shape">8.  A Math formula as an OLE Shape<a class="headerlink" href="#8-a-math-formula-as-an-ole-shape" title="Permanent link">&para;</a></h2>
<p>Draw/Impress documents can include OLE objects through OLE2Shape, which
allows a shape to link to an external document. Probably the most popular kind of
OLE shape is the chart, but I'll delay a detailed discussion of that topic until Part 5,
although there is a code snippet below.</p>
<p>The best way of finding out what OLE objects are available is to go to Draw's (or
Impress') Insert menu, Object, "OLE Object" dialog. It lists Office spreadsheet,
chart, drawing, presentation, and formula documents, and a range of Microsoft and
PDF types (when you click on "Further objects").</p>
<p>The DrawPicture.java OLE example displays a mathematical formula, as in Figure 13.</p>
<p><img alt="" src="images/13-Basic_Shapes-13.png" /></p>
<p>Figure 13. A Math Formula in a Draw Document.</p>
<p>DrawPicture.java renders the formula by calling Draw.addFormula(), which hides the
tricky aspects of instatiating the OLE shape:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="33:1"><input checked="checked" id="__tabbed_33_1" name="__tabbed_33" type="radio" /><div class="tabbed-labels"><label for="__tabbed_33_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in main() in DrawPicture.java</span>
<span class="n">Draw</span><span class="p">.</span><span class="na">drawFormula</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="s">&quot;func e^{i %pi} + 1 = 0&quot;</span><span class="p">,</span>
                                         <span class="mi">23</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">40</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>The second argument is a formula string, written using Office's Math notation. For an
overview, see the "Commands Reference" appendix of the "Math Guide", available
from <a href="https://libreoffice.org/get-help/documentation">https://libreoffice.org/get-help/documentation</a>.</p>
<p>Draw.drawFormula() is coded as:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="34:1"><input checked="checked" id="__tabbed_34_1" name="__tabbed_34" type="radio" /><div class="tabbed-labels"><label for="__tabbed_34_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">drawFormula</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span> <span class="n">String</span> <span class="n">formula</span><span class="p">,</span>
                                 <span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span> <span class="kt">int</span> <span class="n">width</span><span class="p">,</span> <span class="kt">int</span> <span class="n">height</span><span class="p">)</span>
<span class="p">{</span>
  <span class="n">XShape</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">addShape</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="s">&quot;OLE2Shape&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="s">&quot;CLSID&quot;</span><span class="p">,</span> <span class="n">Lo</span><span class="p">.</span><span class="na">MATH_CLSID</span><span class="p">);</span>  <span class="c1">// a formula</span>

  <span class="n">XModel</span> <span class="n">model</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XModel</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                          <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="s">&quot;Model&quot;</span><span class="p">)</span> <span class="p">);</span>
  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="s">&quot;Formula&quot;</span><span class="p">,</span> <span class="n">formula</span><span class="p">);</span>
                      <span class="c1">// from FormulaProperties</span>
  <span class="k">return</span> <span class="n">shape</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of drawFormula()</span>
</code></pre></div>
</div>
</div>
</div>
<p>OLE2Shape uses a "CLSID" property to hold the class ID of the OLE object. Setting
this property affects the shape's model (data format), which is stored in the "Model"
property. drawFormula() casts this property to XModel and, since the model
represents formula data, it has a "Formula" property where the formula string is
stored.</p>
<h4 id="creating-other-kinds-of-ole-shape">Creating Other Kinds of OLE Shape<a class="headerlink" href="#creating-other-kinds-of-ole-shape" title="Permanent link">&para;</a></h4>
<p>The use of a "Formula" property in Draw.drawFormula() only works for an OLE
shape representing a formula. How are other kinds of data stored?</p>
<p>The first step is to set the OLE shape's class ID to the correct value, which will affect
its "Model" property. A short list of class ID constants are included at the start of the
Lo utility class, along with a few commented out IDs which I havent tested.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="35:1"><input checked="checked" id="__tabbed_35_1" name="__tabbed_35" type="radio" /><div class="tabbed-labels"><label for="__tabbed_35_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">Creating</span> <span class="n">an</span> <span class="n">OLE2Shape</span> <span class="k">for</span> <span class="n">a</span> <span class="n">chart</span> <span class="n">begins</span> <span class="n">like</span> <span class="n">so</span><span class="p">:</span>

<span class="n">XShape</span> <span class="n">shape</span> <span class="o">=</span> <span class="n">addShape</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="s">&quot;OLE2Shape&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">);</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="s">&quot;CLSID&quot;</span><span class="p">,</span> <span class="n">Lo</span><span class="p">.</span><span class="na">CHART_CLSID</span><span class="p">);</span>  <span class="c1">// a chart</span>

<span class="n">XModel</span> <span class="n">model</span> <span class="o">=</span> <span class="n">Lo</span><span class="p">.</span><span class="na">qi</span><span class="p">(</span><span class="n">XModel</span><span class="p">.</span><span class="na">class</span><span class="p">,</span>
                          <span class="n">Props</span><span class="p">.</span><span class="na">getProperty</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="s">&quot;Model&quot;</span><span class="p">)</span> <span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Online information on how to use XModel to store a chart, a graphic, or something
else, is pretty sparse. I've found the best start is to list the services that support the
XModel reference. This is done by calling Info.showServices():</p>
<div class="tabbed-set tabbed-alternate" data-tabs="36:1"><input checked="checked" id="__tabbed_36_1" name="__tabbed_36" type="radio" /><div class="tabbed-labels"><label for="__tabbed_36_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="n">Info</span><span class="p">.</span><span class="na">showServices</span><span class="p">(</span><span class="s">&quot;OLE2Shape Model&quot;</span><span class="p">,</span> <span class="n">model</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>For the version of model in drawFormula(), it reports:</p>
<div class="highlight"><pre><span></span><code>OLE2Shape Model Supported Services (2)
  &quot;com.sun.star.document.OfficeDocument&quot;
  &quot;com.sun.star.formula.FormulaProperties&quot;
</code></pre></div>
<p>This gives a strong hint to look inside the FormulaProperties service, to find a
property for storing the formula string. A look at the documentation
(<code>lodoc FormulaProperties service</code>) reveals a "Formula" property, which I used in
drawFormula().</p>
<p>When the model refers to chart data, the same call to Info.showServices() prints:</p>
<div class="highlight"><pre><span></span><code>OLE2Shape Model Supported Services (3)
  &quot;com.sun.star.chart.ChartDocument&quot;
  &quot;com.sun.star.chart2.ChartDocument&quot;
  &quot;com.sun.star.document.OfficeDocument&quot;
</code></pre></div>
<p>The com.sun.star.chart2 package is the newer way of manipulating charts, which
suggests that the XModel interfaces should be converted to an interface of
com.sun.star.chart2.ChartDocument. The most useful is XChartDocument, which is
obtained via:
XChartDocument chartDoc = Lo.qi(XChartDocument.class, model);
XChartDocument supports a rich set of chart manipulation methods.  I'll return to
charts in Part 5.</p>
<h2 id="9-polygons">9.  Polygons<a class="headerlink" href="#9-polygons" title="Permanent link">&para;</a></h2>
<p>The main() function of AnimBicycle.java calls Draw.drawPolygon() twice to create
regular polygons for a square and pentagon:</p>
<p>// in AnimBicycle.java
XShape square = Draw.drawPolygon(currSlide, 125, 125, 25, 4);
                                  // (x,y), radius, no. of sides
Props.setProperty(square, "FillColor", 0x3fe694);  // pale green</p>
<p>XShape pentagon = Draw.drawPolygon(currSlide, 150, 75, 5);
                                  // (x,y), no. of sides
                                  // radius uses a default value
Props.setProperty(pentagon, "FillColor", 0xe7b9c7);  // purple</p>
<p>The polygons can be seen in Figure 14.</p>
<p><img alt="" src="images/13-Basic_Shapes-14.png" /></p>
<p>Figure 14. Bicycle and Shapes.</p>
<p>Draw.drawPolygon() is:</p>
<p>// in the Draw class
public static XShape drawPolygon(XDrawPage slide,
                    int x, int y, int radius, int nSides)
{
  XShape polygon = addShape(slide, "PolyPolygonShape", 0, 0, 0, 0);
     // for shapes formed by one <em>or more</em> polygons</p>
<p>Point[] pts = genPolygonPoints(x, y, radius, nSides);
  Point[][] polys = new Point[][] {pts};
     // an array of Point arrays, one Point array for each polygon</p>
<p>Props.setProperty(polygon, "PolyPolygon", polys);
  return polygon;
}  // end of drawPolygon()</p>
<p>drawPolygon() creates a "PolyPolygonShape" shape which is designed to store
multiple polygons. This is why the polys data structure instantiated at the end of
drawPolygon()  is an array of points arrays, since the shape's "PolyPolygon" property
can hold multiple point arrays. However, drawPolygon() only creates a single points
array by calling genPolygonPoints().</p>
<p>A points array defining the four points of a square could be:</p>
<div class="highlight"><pre><span></span><code>Point[] pts = new Point[4];
pts[0] = new Point(4000, 1200);
pts[1] = new Point(4000, 2000);
pts[2] = new Point(5000, 2000);
pts[3] = new Point(5000, 1200);
</code></pre></div>
<p>Note that the coordinates of each point use Office's 1/100 mm units.</p>
<p>genPolygonPoints() generates a points array for a regular polygon based on the
coordinate of the center of the polygon, the distance from the center to each point (the
shape's radius), and the required number of sides:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="37:1"><input checked="checked" id="__tabbed_37_1" name="__tabbed_37" type="radio" /><div class="tabbed-labels"><label for="__tabbed_37_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="kd">private</span> <span class="kd">static</span> <span class="n">Point</span><span class="o">[]</span> <span class="nf">genPolygonPoints</span><span class="p">(</span><span class="kt">int</span> <span class="n">x</span><span class="p">,</span> <span class="kt">int</span> <span class="n">y</span><span class="p">,</span>
                                  <span class="kt">int</span> <span class="n">radius</span><span class="p">,</span> <span class="kt">int</span> <span class="n">nSides</span><span class="p">)</span>
<span class="p">{</span> <span class="k">if</span> <span class="p">(</span><span class="n">nSides</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Too few sides; must be 3 or more&quot;</span><span class="p">);</span>
    <span class="n">nSides</span> <span class="o">=</span> <span class="mi">3</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">nSides</span> <span class="o">&gt;</span> <span class="mi">30</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Too many sides; must be 30 or less&quot;</span><span class="p">);</span>
    <span class="n">nSides</span> <span class="o">=</span> <span class="mi">30</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="n">Point</span><span class="o">[]</span> <span class="n">pts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="o">[</span><span class="n">nSides</span><span class="o">]</span><span class="p">;</span>
  <span class="kt">double</span> <span class="n">angleStep</span> <span class="o">=</span> <span class="n">Math</span><span class="p">.</span><span class="na">PI</span><span class="o">/</span><span class="n">nSides</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">nSides</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">pts</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span>
       <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">Math</span><span class="p">.</span><span class="na">round</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="mi">100</span> <span class="o">+</span>
                        <span class="n">radius</span><span class="o">*</span><span class="mi">100</span> <span class="o">*</span> <span class="n">Math</span><span class="p">.</span><span class="na">cos</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">angleStep</span><span class="p">)),</span>
       <span class="p">(</span><span class="kt">int</span><span class="p">)</span> <span class="n">Math</span><span class="p">.</span><span class="na">round</span><span class="p">(</span><span class="n">y</span><span class="o">*</span><span class="mi">100</span> <span class="o">+</span>
                        <span class="n">radius</span><span class="o">*</span><span class="mi">100</span> <span class="o">*</span> <span class="n">Math</span><span class="p">.</span><span class="na">sin</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="n">angleStep</span><span class="p">))</span> <span class="p">);</span>
  <span class="p">}</span>
  <span class="k">return</span> <span class="n">pts</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of genPolygonPoints()</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="10-mult-line-shapes">10. Mult-line Shapes<a class="headerlink" href="#10-mult-line-shapes" title="Permanent link">&para;</a></h2>
<p>A PolyLineShape can hold multiple line paths, where a path is a sequence of
connected lines. Draw.drawLines() only creates a single line path, based on being
passed arrays of x- and  y- axis coordinates. For example, the following code in
AnimBicycle creates the crossed lines at the top-left of Figure 14:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="38:1"><input checked="checked" id="__tabbed_38_1" name="__tabbed_38" type="radio" /><div class="tabbed-labels"><label for="__tabbed_38_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in AnimBicycle.java</span>
<span class="kt">int</span><span class="o">[]</span> <span class="n">xs</span> <span class="o">=</span> <span class="p">{</span><span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">};</span>
<span class="kt">int</span><span class="o">[]</span> <span class="n">ys</span> <span class="o">=</span> <span class="p">{</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">};</span>
<span class="n">Draw</span><span class="p">.</span><span class="na">drawLines</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">);</span>
</code></pre></div>
</div>
</div>
</div>
<p>Draw.drawLines() is:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="39:1"><input checked="checked" id="__tabbed_39_1" name="__tabbed_39" type="radio" /><div class="tabbed-labels"><label for="__tabbed_39_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in the Draw class</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="n">XShape</span> <span class="nf">drawLines</span><span class="p">(</span><span class="n">XDrawPage</span> <span class="n">slide</span><span class="p">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">xs</span><span class="p">,</span> <span class="kt">int</span><span class="o">[]</span> <span class="n">ys</span><span class="p">)</span>
<span class="p">{</span>
  <span class="k">if</span> <span class="p">(</span><span class="n">xs</span><span class="p">.</span><span class="na">length</span> <span class="o">!=</span> <span class="n">ys</span><span class="p">.</span><span class="na">length</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;The two arrays must be the same length&quot;</span><span class="p">);</span>
    <span class="k">return</span> <span class="kc">null</span><span class="p">;</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="n">numPoints</span> <span class="o">=</span> <span class="n">xs</span><span class="p">.</span><span class="na">length</span><span class="p">;</span>
  <span class="n">Point</span><span class="o">[]</span> <span class="n">pts</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="o">[</span><span class="n">numPoints</span><span class="o">]</span><span class="p">;</span>
  <span class="k">for</span> <span class="p">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">numPoints</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
    <span class="n">pts</span><span class="o">[</span><span class="n">i</span><span class="o">]</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="p">(</span><span class="n">xs</span><span class="o">[</span><span class="n">i</span><span class="o">]*</span><span class="mi">100</span><span class="p">,</span> <span class="n">ys</span><span class="o">[</span><span class="n">i</span><span class="o">]*</span><span class="mi">100</span><span class="p">);</span>  <span class="c1">//in 1/100 mm units</span>

  <span class="n">Point</span><span class="o">[][]</span> <span class="n">linePaths</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Point</span><span class="o">[][]</span> <span class="p">{</span><span class="n">pts</span><span class="p">};</span>
    <span class="c1">// an array of Point arrays, one Point array for each line path</span>

  <span class="n">XShape</span> <span class="n">polyLine</span> <span class="o">=</span> <span class="n">addShape</span><span class="p">(</span><span class="n">slide</span><span class="p">,</span> <span class="s">&quot;PolyLineShape&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
     <span class="c1">// for a shape formed from multiple line paths</span>

  <span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">polyLine</span><span class="p">,</span> <span class="s">&quot;PolyPolygon&quot;</span><span class="p">,</span> <span class="n">linePaths</span><span class="p">);</span>
  <span class="k">return</span> <span class="n">polyLine</span><span class="p">;</span>
<span class="p">}</span>  <span class="c1">// end of drawLines()</span>
</code></pre></div>
</div>
</div>
</div>
<p>drawLines() creates an array of Point arrays which is stored in the PolyLineShape
property called "PolyPolygon". However, drawLines() only adds a single points array
to the linePaths data structure since only one line path is being created.</p>
<h2 id="11-partial-ellipses">11.  Partial Ellipses<a class="headerlink" href="#11-partial-ellipses" title="Permanent link">&para;</a></h2>
<p>EllipseShape contains a "CircleKind" property that determines whether the entire
ellipse should be drawn, or only a portion of it. The properties "CircleStartAngle" and
"CircleEndAngle" define the angles where the solid part of the ellipse starts and
finishes. Zero degrees is the positive x-axis, and the angle increase in 1/100 degrees
units counter-clockwise around the center of the ellipse.</p>
<p>AnimBicycle.java contains the following example:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="40:1"><input checked="checked" id="__tabbed_40_1" name="__tabbed_40" type="radio" /><div class="tabbed-labels"><label for="__tabbed_40_1">java</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1">// in AnimBicycle.java</span>
<span class="n">XShape</span> <span class="n">pie</span> <span class="o">=</span> <span class="n">Draw</span><span class="p">.</span><span class="na">drawEllipse</span><span class="p">(</span><span class="n">currSlide</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span>
                               <span class="n">slideSize</span><span class="p">.</span><span class="na">Width</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">20</span><span class="p">);</span>

<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">pie</span><span class="p">,</span> <span class="s">&quot;CircleStartAngle&quot;</span><span class="p">,</span> <span class="mi">9000</span><span class="p">);</span> <span class="c1">// 90 degrees ccw</span>
<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">pie</span><span class="p">,</span> <span class="s">&quot;CircleEndAngle&quot;</span><span class="p">,</span> <span class="mi">36000</span><span class="p">);</span>  <span class="c1">// 360 degrees ccw</span>

<span class="n">Props</span><span class="p">.</span><span class="na">setProperty</span><span class="p">(</span><span class="n">pie</span><span class="p">,</span> <span class="s">&quot;CircleKind&quot;</span><span class="p">,</span> <span class="n">CircleKind</span><span class="p">.</span><span class="na">SECTION</span><span class="p">);</span>
                         <span class="c1">// CircleKind.CUT, CircleKind.ARC</span>
</code></pre></div>
</div>
</div>
</div>
<p>This creates the blue partial ellipse shown at the bottom left of Figure 14.</p>
<p>Figure 15 shows the different results when "CircleKind" is set to
CircleKind.SECTION, CircleKind.CUT, and CircleKind.ARC.</p>
<p><img alt="" src="images/13-Basic_Shapes-15.png" /></p>
<p>Figure 15. Different Types of Partial Ellipse</p>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="12-Examining_DrawImpress.html" class="md-footer__link md-footer__link--prev" aria-label="Previous: Chapter 12. Examining a Draw/Impress Document" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 12. Examining a Draw/Impress Document
            </div>
          </div>
        </a>
      
      
        
        <a href="14-Animation.html" class="md-footer__link md-footer__link--next" aria-label="Next: Chapter 14. Animation" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Chapter 14. Animation
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "assets/javascripts/workers/search.22074ed6.min.js"}</script>
    
    
      <script src="assets/javascripts/bundle.960e086b.min.js"></script>
      
    
  </body>
</html>