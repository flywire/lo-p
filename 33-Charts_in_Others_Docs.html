
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="LibreOffice Programming (LO-P) is intended for programmers who want  to learn how to use the the LibreOffice API. This allows programs to control  and manipulate LibreOffice's text, drawing, presentation, spreadsheet, and  database applications, and a lot more (e.g. its spell checker, forms  designer, and charting tools).  ">
      
      
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.2.2, mkdocs-material-7.0.6">
    
    
      
        <title>Chapter 33. Using Charts in Other Documents - LibreOffice Programming</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="assets/stylesheets/palette.7fa14f5b.min.css">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
      <link rel="stylesheet" href="css/extra.css">
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="preference" data-md-color-primary="" data-md-color-accent="">
      
        <script>matchMedia("(prefers-color-scheme: dark)").matches&&document.body.setAttribute("data-md-color-scheme","slate")</script>
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter-33-using-charts-in-other-documents" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="index.html" title="LibreOffice Programming" class="md-header__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            LibreOffice Programming
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter 33. Using Charts in Other Documents
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" data-md-state="active" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="index.html" title="LibreOffice Programming" class="md-nav__button md-logo" aria-label="LibreOffice Programming" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    LibreOffice Programming
  </label>
  
    <div class="md-nav__source">
      
<a href="https://github.com/flywire/lo-p/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M439.55 236.05L244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    lo-p
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="index.html" class="md-nav__link">
        Preface
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01%20Part%201%20Basics.html" class="md-nav__link">
        Part 1 Basics
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="01-Concepts.html" class="md-nav__link">
        Chapter 1. LibreOffice API Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="02-Starting_and_Stopping.html" class="md-nav__link">
        Chapter 2. Starting and Stopping
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="03-Examining.html" class="md-nav__link">
        Chapter 3. Examining
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="04-Listening.html" class="md-nav__link">
        Chapter 4. Listening, and Other Techniques
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05%20Part%202%20Writer.html" class="md-nav__link">
        Part 2 Writer
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="05-Text_API_Overview.html" class="md-nav__link">
        Chapter 5. Text API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="06-Text_Styles.html" class="md-nav__link">
        Chapter 6. Text Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="07-Non-text_Content.html" class="md-nav__link">
        Chapter 7. Text Content Other than Strings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="08-Graphic_Content.html" class="md-nav__link">
        Chapter 8. Graphic Content
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="09-Text_Search.html" class="md-nav__link">
        Chapter 9. Text Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="10-Linguistics.html" class="md-nav__link">
        Chapter 10. The Linguistics API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11%20Part%203%20Draw%20%26%20Impress.html" class="md-nav__link">
        Part 3 Draw & Impress
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="11-Draw_Impress_APIs.html" class="md-nav__link">
        Chapter 11. Draw/Impress APIs Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="12-Examining_DrawImpress.html" class="md-nav__link">
        Chapter 12. Examining a Draw/Impress Document
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="13-Basic_Shapes.html" class="md-nav__link">
        Chapter 13. Drawing Basic Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="14-Animation.html" class="md-nav__link">
        Chapter 14. Animation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="15-Complex_Shapes.html" class="md-nav__link">
        Chapter 15. Complex Shapes
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="16-Making_Slides.html" class="md-nav__link">
        Chapter 16. Making Slides
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="17-Slide_Deck_Manipulation.html" class="md-nav__link">
        Chapter 17. Slide Deck Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="18-Slide_Shows.html" class="md-nav__link">
        Chapter 18. Slide Shows
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19%20Part%204%20Calc.html" class="md-nav__link">
        Part 4 Calc
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="19-Calc_API_Overview.html" class="md-nav__link">
        Chapter 19. Calc API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="20-Spreadsheet_Manipulation.html" class="md-nav__link">
        Chapter 20. Spreadsheet Displaying and Creation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="21-Extracting_Data.html" class="md-nav__link">
        Chapter 21. Extracting Data
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="22-Styles.html" class="md-nav__link">
        Chapter 22. Styles
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="23-Garlic_Secrets.html" class="md-nav__link">
        Chapter 23. Garlic Secrets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="24-Complex_Data_Manipulation.html" class="md-nav__link">
        Chapter 24. Complex Data Manipulation
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="25-Monitoring_Sheets.html" class="md-nav__link">
        Chapter 25. Monitoring Sheets
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="26-Search_Replace.html" class="md-nav__link">
        Chapter 26. Search and Replace
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="27-Funcs_Analysis.html" class="md-nav__link">
        Chapter 27. Functions and Data Analysis
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28%20Part%205%20Chart.html" class="md-nav__link">
        Part 5 Chart
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="28-Chart2_API_Overview.html" class="md-nav__link">
        Chapter 28. Chart2 API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="29-Column_Charts.html" class="md-nav__link">
        Chapter 29. Column Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="30-Bar_Pie_Area_Line_Charts.html" class="md-nav__link">
        Chapter 30. Bar, Pie, Area, Line Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="31-XY_Scatter_Charts.html" class="md-nav__link">
        Chapter 31. XY (Scatter) Charts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="32-Bubble_Net_Stock_Charts.html" class="md-nav__link">
        Chapter 32. Bubble, Net, Stock Charts
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Chapter 33. Using Charts in Other Documents
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="33-Charts_in_Others_Docs.html" class="md-nav__link md-nav__link--active">
        Chapter 33. Using Charts in Other Documents
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-clipboard-manipulation-requires-the-use-of-uno-dispatch-commands-namely" class="md-nav__link">
    1.  Clipboard manipulation requires the use of UNO dispatch commands (namely
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-another-timing-problem-is-that-dispatch-commands-assume-that-the-office" class="md-nav__link">
    2.  Another timing problem is that dispatch commands assume that the Office
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-clipboard-programming-usually-involves-two-documents-in-this-case-the" class="md-nav__link">
    3.  Clipboard programming usually involves two documents. In this case, the
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-adding-a-chart-to-a-text-document" class="md-nav__link">
    1.  Adding a Chart to a Text Document
  </a>
  
    <nav class="md-nav" aria-label="1.  Adding a Chart to a Text Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-making-the-chart" class="md-nav__link">
    1.1.  Making the Chart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-copying-a-chart" class="md-nav__link">
    1.2.  Copying a Chart
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-adding-a-chart-to-a-slide-document" class="md-nav__link">
    2.  Adding a Chart to a Slide Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-saving-the-chart-as-an-image" class="md-nav__link">
    3.  Saving the Chart as an Image
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34%20Part%206%20Base.html" class="md-nav__link">
        Part 6 Base
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="34-JDBC_to_Base_API.html" class="md-nav__link">
        Chapter 34. From JDBC to the Base API
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="35-Examining_Base_Docs.html" class="md-nav__link">
        Chapter 35. Examining Base Documents
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="36-RowSets_DB_Context.html" class="md-nav__link">
        Chapter 36. Using RowSets and Database Context
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="37-Driver_Manager.html" class="md-nav__link">
        Chapter 37. Using the Driver Manager
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="38-ODB_as_Zip.html" class="md-nav__link">
        Chapter 38. Treating an ODB File as a Zipped Folder
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39%20Part%207%20Cross-application.html" class="md-nav__link">
        Part 7 Cross-application
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="39-Forms_API_Overview.html" class="md-nav__link">
        Chapter 39. Forms API Overview
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="40-Building_a_Form.html" class="md-nav__link">
        Chapter 40. Building a Form Programmatically
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="41-Printing.html" class="md-nav__link">
        Chapter 41. Printing
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="42-Sending_E-mail.html" class="md-nav__link">
        Chapter 42. Sending E-mail
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="43-Using_the_Clipboard.html" class="md-nav__link">
        Chapter 43. Using the Clipboard
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="44-Office_as_GUI_Comp.html" class="md-nav__link">
        Chapter 44. Office as a GUI Component
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45%20Part%208%20Extending%20LibreOffice.html" class="md-nav__link">
        Part 8 Extending LibreOffice
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="45-UNO_Components.html" class="md-nav__link">
        Chapter 45. Coding UNO Components
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="46-Addons.html" class="md-nav__link">
        Chapter 46. Add-ons
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="47-Calc_Add-ins.html" class="md-nav__link">
        Chapter 47. Calc Add-ins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="48-Event_Macros.html" class="md-nav__link">
        Chapter 48. Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="49-Ext_Doc_Event_Macros.html" class="md-nav__link">
        Chapter 49. Extension and Document Event Macros
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50%20Part%209%20The%20ODF%20Format.html" class="md-nav__link">
        Part 9 The ODF Format
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="50-Importing_XML.html" class="md-nav__link">
        Chapter 50. Importing XML
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="51-Simple_ODF.html" class="md-nav__link">
        Chapter 51. Simple ODF
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-clipboard-manipulation-requires-the-use-of-uno-dispatch-commands-namely" class="md-nav__link">
    1.  Clipboard manipulation requires the use of UNO dispatch commands (namely
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-another-timing-problem-is-that-dispatch-commands-assume-that-the-office" class="md-nav__link">
    2.  Another timing problem is that dispatch commands assume that the Office
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-clipboard-programming-usually-involves-two-documents-in-this-case-the" class="md-nav__link">
    3.  Clipboard programming usually involves two documents. In this case, the
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-adding-a-chart-to-a-text-document" class="md-nav__link">
    1.  Adding a Chart to a Text Document
  </a>
  
    <nav class="md-nav" aria-label="1.  Adding a Chart to a Text Document">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-making-the-chart" class="md-nav__link">
    1.1.  Making the Chart
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-copying-a-chart" class="md-nav__link">
    1.2.  Copying a Chart
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-adding-a-chart-to-a-slide-document" class="md-nav__link">
    2.  Adding a Chart to a Slide Document
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-saving-the-chart-as-an-image" class="md-nav__link">
    3.  Saving the Chart as an Image
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/flywire/lo-p/edit/master/docs/33-Charts_in_Others_Docs.md" title="Edit this page" class="md-content__button md-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
                  </a>
                
                
                <h1 id="chapter-33-using-charts-in-other-documents">Chapter 33. Using Charts in Other Documents</h1>
<div class="admonition note">
<p class="admonition-title">Topics</p>
<p>Copy-and-Paste 
Dispatches; Adding a 
Chart to a Text 
Document; Adding a 
Chart to a Slide 
Document; Saving the 
Chart as an Image </p>
<p>Example folders: 
"Chart2 Tests" and 
"Utils" </p>
</div>
<p>This chapter describes two examples, TextChart.java and 
SlideChart.java, which illustrate a copy-and-paste 
approach to adding charts to text and slide documents. </p>
<p>SlideChart.java also shows how to save a chart as an 
image file. </p>
<p>There are three tricky aspects to coding with the clipboard.  </p>
<h2 id="1-clipboard-manipulation-requires-the-use-of-uno-dispatch-commands-namely">1.  Clipboard manipulation requires the use of UNO dispatch commands (namely</h2>
<p>".uno:Copy" and ".uno:Paste"). The function that sends out a dispatch command 
returns immediately, but Office may take a few milliseconds to process the request. </p>
<p>This often introduces a timing issue because the next step in the program should be 
delayed in order to give the dispatch time to be processed.  </p>
<h2 id="2-another-timing-problem-is-that-dispatch-commands-assume-that-the-office">2.  Another timing problem is that dispatch commands assume that the Office</h2>
<p>application window is visible and active. Office can be made the focus of the OS, but 
the few milliseconds between achieving this and sending the dispatch may be enough 
for another OS process to pull the focus away from Office. The dispatch will then 
arrive at the wrong process, with unpredictable results. </p>
<h2 id="3-clipboard-programming-usually-involves-two-documents-in-this-case-the">3.  Clipboard programming usually involves two documents. In this case, the</h2>
<p>spreadsheet that generates the chart, and the text or slide document that receives the 
image. One of the limitations of my support classes is that many methods assume only 
one document is open at a time. To be safe, the program should close the spreadsheet 
before the text or slide document is opened or created. </p>
<p>Bearing all these issues in mind, is there a better approach for placing a chart in a non-
spreadsheet document? The answer should be OLE (Object Linking and Embedding), 
which is Windows' solution to this very problem. Unfortunately, I was unable to get 
this mechanism to work via the API; the best I achieved was the creation of an empty 
chart in a text document, without any data. Looking back through old forum posts, it 
appears that OLE didn't work in the old chart module either. </p>
<p>I'll look again at clipboard programming in Chapter 43, when I consider using Java's 
copy-and-paste API, and describe more general examples using Writer, Calc, Impress, 
and Base documents. </p>
<h2 id="1-adding-a-chart-to-a-text-document">1.  Adding a Chart to a Text Document</h2>
<p>TextChart.java generates a column chart using the "Sneakers Sold this Month" table 
from chartsData.ods, copies it to the clipboard, and closes the spreadsheet. Then a text 
document is created, and the chart image is pasted into it, resulting in the page shown 
in Figure 1. </p>
<p><img alt="" src="images/33-Charts_in_Others_Docs-1.png" /></p>
<p>Figure 1. Text Document with a Chart Image. </p>
<p>TextChart.java relies on my Write support class from Part 2. The "Hello LibreOffice." 
paragraph is written into a new document, then the chart is pasted in from the 
clipboard, a paragraph ("Figure 1. Sneakers Bar Chart") added as a figure legend, and 
another paragraph ("Some more textâ€¦") added at the end for good measure. The 
document is saved to "hello.odt" and the program ends. </p>
<p>main() is: </p>
<p>// in TextChart.java 
public static void main(String[] args) 
{ 
  XComponentLoader loader = Lo.loadOffice(); 
  boolean hasChart = makeColChart(loader, "chartsData.ods"); </p>
<p>XTextDocument doc = Write.createDoc(loader); 
  if (doc == null) { 
    System.out.println("Writer doc creation failed"); 
    Lo.closeOffice(); 
    return; 
  } 
  GUI.setVisible(doc, true);  // to make the doc visible </p>
<p>XTextCursor cursor = Write.getCursor(doc); 
  cursor.gotoEnd(false);  <br />
                // make sure at end of doc before appending 
  Write.appendPara(cursor, "Hello LibreOffice.\n"); </p>
<p>if (hasChart) { 
    Lo.delay(1000); 
    Lo.dispatchCmd("Paste");<br />
  } </p>
<p>// add chart legend 
  Write.appendPara(cursor, "Figure 1. Sneakers Column Chart.\n"); 
  Write.stylePrevParagraph(cursor, "ParaAdjust",<br />
                       com.sun.star.style.ParagraphAdjust.CENTER); </p>
<p>Write.appendPara(cursor, "Some more text...\n"); 
  Lo.saveDoc(doc, "hello.odt"); </p>
<p>Lo.waitEnter(); 
  Lo.closeDoc(doc); 
  Lo.closeOffice(); 
} // end of main() </p>
<p>It's important that the text document is visible and in focus, so GUI.setVisible() is 
called after the document's creation. There's also a call to Lo.delay() before the paste 
(Lo.dispatchCmd("Paste")) to ensure that earlier text writes have time to finish. </p>
<h3 id="11-making-the-chart">1.1.  Making the Chart</h3>
<p>TextChart.java uses makeColChart() to generate a chart from a spreadsheet: </p>
<p>// in TextChart.java 
private static boolean makeColChart(XComponentLoader loader,<br />
                                    String fnm) 
// draw a column chart; uses "Sneakers Sold this Month" table 
// this method appears in TextChart.java and SlideChart.java 
{ 
  XSpreadsheetDocument ssdoc = Calc.openDoc(fnm, loader); 
  if (ssdoc == null) { 
    System.out.println("Could not open " + fnm); 
    return false; 
  } 
  GUI.setVisible(ssdoc, true);  // or selection not copied 
  XSpreadsheet sheet = Calc.getSheet(ssdoc, 0); 
  CellRangeAddress rangeAddr = Calc.getAddress(sheet, "A2:B8"); 
  XChartDocument chartDoc = 
        Chart2.insertChart(sheet, rangeAddr, "C3",15,11,"Column"); </p>
<p>Chart2.setTitle(chartDoc, Calc.getString(sheet, "A1")); 
  Chart2.setXAxisTitle(chartDoc, Calc.getString(sheet, "A2")); 
  Chart2.setYAxisTitle(chartDoc, Calc.getString(sheet, "B2")); 
  Chart2.rotateYAxisTitle(chartDoc, 90); </p>
<p>Lo.delay(1000); 
  Chart2.copyChart(ssdoc, sheet); 
  Lo.closeDoc(ssdoc); 
  return true; 
}  // end of makeColChart() </p>
<p>makeColChart() uses the table from chartsData.ods shown in Figure 2 to generate the 
chart in Figure 1.  </p>
<p><img alt="" src="images/33-Charts_in_Others_Docs-2.png" /></p>
<p>Figure 2. The "Sneakers Sold this Month" Table. </p>
<p>The only new feature in makeColChart() is the call to Chart2.copyChart() which 
copies the chart to the clipboard.  </p>
<p>Two easy to overlook parts of makeColChart() are the call to GUI.setVisible(), which 
makes the spreadsheet and chart visible and active, and the call to Lo.delay() before 
Chart2.copyChart(). This ensures that there's enough time for the graph to be drawn 
before the ".uno:Copy" dispatch. </p>
<p>Also note that the spreadsheet is closed before makeColChart() returns. This stops the 
subsequent creation of the text document back in main() from being possibly affected 
by an open spreadsheet </p>
<h3 id="12-copying-a-chart">1.2.  Copying a Chart</h3>
<p>Chart2.copyChart() obtains a reference to the chart as an XShape, which makes it 
possible to select it with an XSelectionSupplier. This selection is used automatically 
as the data for  the ".uno:Copy" dispatch. copyChart() is: </p>
<p>// in the Chart2 class 
public static void copyChart(XSpreadsheetDocument ssdoc,<br />
                                       XSpreadsheet sheet) 
{ XShape chartShape = getChartShape(sheet); 
  XComponent doc = Lo.qi(XComponent.class, ssdoc); 
  XSelectionSupplier supplier = GUI.getSelectionSupplier(doc); 
  supplier.select((Object)chartShape); 
  Lo.dispatchCmd("Copy");<br />
}  // end of copyChart() </p>
<p>Every spreadsheet is also a draw page, so the Spreadsheet service has an 
XDrawPageSupplier interface, and its getDrawPage() method returns an XDrawPage 
reference. For example: </p>
<p>// part of Chart2.getChartShape(); see below... </p>
<p>XDrawPageSupplier pageSupplier =<br />
                         Lo.qi(XDrawPageSupplier.class, sheet);<br />
XDrawPage drawPage = pageSupplier.getDrawPage();  </p>
<p>The shapes in a draw page can be accessed by index. Also each shape has a "CLSID" 
property which can be used to identify 'special' shapes representing math formulae or 
charts. The search for a chart shape is coded as: </p>
<p>// part of Chart2.getChartShape(); see below... </p>
<p>XShape shape = null; 
String classID; 
int numShapes = drawPage.getCount();<br />
for (int i=0; i &lt; numShapes; i++) {  // loop through shapes 
  try { 
    shape = Lo.qi(XShape.class, drawPage.getByIndex(i));<br />
    classID = (String) Props.getProperty(shape, "CLSID"); 
    if (classID.toLowerCase().equals(Lo.CHART_CLSID)) 
      // check if shape's class ID is for a chart 
      break; 
  } 
  catch(Exception e) {} 
} </p>
<p>These two pieces of code are combined in Chart2.getChartShape(): </p>
<p>// in the Chart2 class 
public static XShape getChartShape(XSpreadsheet sheet) 
{ 
  XDrawPageSupplier pageSupplier =<br />
                        Lo.qi(XDrawPageSupplier.class, sheet);<br />
  XDrawPage drawPage = pageSupplier.getDrawPage();<br />
  XShape shape = null; 
  String classID; 
  int numShapes = drawPage.getCount();<br />
  for (int i=0; i &lt; numShapes; i++) { 
    try { 
      shape = Lo.qi(XShape.class, drawPage.getByIndex(i));<br />
      classID = (String) Props.getProperty(shape, "CLSID"); 
      if (classID.toLowerCase().equals(Lo.CHART_CLSID)) 
        break; 
    } 
    catch(Exception e) {} 
  } 
  return shape; 
}  // end of getChartShape() </p>
<h2 id="2-adding-a-chart-to-a-slide-document">2.  Adding a Chart to a Slide Document</h2>
<p>SlideChart.java generates the same column chart as TableChart.java, using almost the 
same version of makeColChart(). After the chart has been copied to the clipboard and 
the spreadsheet closed, a slide document is created and the chart pasted onto the first 
slide. The chart appears in the center of the slide by default, but is moved down to 
make room for some text. The end result is shown in Figure 3. </p>
<p><img alt="" src="images/33-Charts_in_Others_Docs-3.png" /></p>
<p>Figure 3. Slide Document with a Chart Shape. </p>
<p>The main() function of SlideChart.java is: </p>
<p>// in SlideChart.java 
public static void main (String args[]) 
{ 
  XComponentLoader loader = Lo.loadOffice(); </p>
<p>boolean hasChart = makeColChart(loader, "chartsData.ods"); </p>
<p>XComponent doc = Draw.createImpressDoc(loader); 
  if (doc == null) { 
    System.out.println("Draw doc creation failed"); 
    Lo.closeOffice(); 
    return; 
  } 
  GUI.setVisible(doc, true); </p>
<p>XDrawPage currSlide = Draw.getSlide(doc, 0); 
  XText body = Draw.bulletsSlide(currSlide,<br />
                          "Sneakers Are Selling!"); 
  Draw.addBullet(body, 0, "Sneaker profits have increased"); </p>
<p>if (hasChart) { 
    Lo.delay(1000); 
    Lo.dispatchCmd("Paste");<br />
  } </p>
<p>// find and move picture 
  XShape oleShape =<br />
         Draw.findShapeByType(currSlide,<br />
                       "com.sun.star.drawing.OLE2Shape"); 
  if (oleShape != null) { 
    Size slideSize = Draw.getSlideSize(currSlide); 
    Size shapeSize = Draw.getSize(oleShape); 
    Point shapePos = Draw.getPosition(oleShape); 
    int y = slideSize.Height - shapeSize.Height - 20; 
    Draw.setPosition(oleShape, shapePos.X, y);    // move pic down 
  } </p>
<p>Lo.saveDoc(doc, "makeslide.odp"); 
  Lo.waitEnter(); 
  Lo.closeDoc(doc); 
  Lo.closeOffice(); 
} // end of main() </p>
<p>The chart is pasted into the slide as an OLE2Shape object, which allows it to be found 
by Draw.findShapeByType(). The shape is moved down the slide by calculating a 
new (x, y) coordinate for its top-left corner, and calling Draw.setPosition(). </p>
<h2 id="3-saving-the-chart-as-an-image">3.  Saving the Chart as an Image</h2>
<p>The only change to makeColChart() in SlideChart.java is the addition of the line: </p>
<p>// in makeColChart() in SlideChart.java 
Images.saveImage( Chart2.getChartImage(sheet), "chartImage.png"); </p>
<p>This saves the chart as a PNG image, which can be loaded by other applications. </p>
<p>Images.saveImage() accepts a BufferedImage argument and filename: </p>
<p>// in Images class 
public static void saveImage(BufferedImage im, String fnm) 
{ 
  try {     <br />
    System.out.println("Saving image to " + fnm); 
    ImageIO.write(im, "png", new File(fnm)); 
  }<br />
  catch (java.io.IOException e) { 
    System.out.println("Could not save image to " + fnm +": "+ e); 
  } 
}  // end of saveImage() </p>
<p>Chart2.getChartImage() finds the chart in the spreadsheet and returns it as a 
BufferedImage object.  </p>
<p>// in the Chart2 class 
public static BufferedImage getChartImage(XSpreadsheet sheet) 
{ 
  XShape chartShape = Chart2.getChartShape(sheet); 
  if (chartShape == null) { 
    System.out.println("Could not find a chart"); 
    return null; 
  } 
  XGraphic graphic = Lo.qi( XGraphic.class,<br />
                   Props.getProperty(chartShape, "Graphic") ); 
  if (graphic == null) { 
    System.out.println("No chart graphic found"); 
    return null; 
  } </p>
<p>String tempFnm = FileIO.createTempFile("png"); 
  if (tempFnm == null) { 
    System.out.println("Could not create a temp file for graphic"); 
    return null; 
  } </p>
<p>Images.saveGraphic(graphic, tempFnm, "png"); 
  BufferedImage im = Images.loadImage(tempFnm); 
  FileIO.deleteFile(tempFnm); 
  return im; 
}  // end of getChartImage() </p>
<p>Chart2.getChartImage() finds the chart in the sheet by using Chart2.getChartShape() 
described earlier. The shape is cast to an Office graphics object, of type XGraphic. </p>
<p>getChartImage() then creates a temporary file to store the XGraphic image, which is 
immediately re-loaded as a BufferedImage. This is a bit nasty, but the only way I've 
found to convert XGraphic to BufferedImage. </p>
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="32-Bubble_Net_Stock_Charts.html" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Chapter 32. Bubble, Net, Stock Charts
            </div>
          </div>
        </a>
      
      
        <a href="34%20Part%206%20Base.html" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Part 6 Base
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": ".", "features": [], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>